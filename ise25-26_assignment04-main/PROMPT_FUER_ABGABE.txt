Project Requirement Proposal (PRP)

Feature: Import eines Point-of-Sale (POS) aus OpenStreetMap (CampusCoffee)

⸻

Goal

Feature Goal:
Ermögliche den Import eines neuen Point-of-Sale (POS) aus einem OpenStreetMap-Node in das CampusCoffee-System.

Deliverable:
Ein funktionierender REST-Endpunkt (POST /api/pos/import/osm/{nodeId}), der
	1.	OSM-Daten abruft,
	2.	XML-Inhalte liest und umwandelt,
	3.	sie im CampusCoffee-Datenmodell speichert oder aktualisiert,
	4.	und die Ergebnisse als JSON zurückgibt.

Success Definition:
Der Endpunkt kann mit
curl -X POST http://localhost:8080/api/pos/import/osm/5589879349
aufgerufen werden und erzeugt oder aktualisiert erfolgreich einen POS in der Datenbank 

User Persona

Target User:
Administrator oder Entwickler, der neue Standorte aus OpenStreetMap in CampusCoffee importieren möchte.

Use Case:
Beim Onboarding eines neuen Campus-Cafés werden POS-Daten aus einem existierenden OSM-Eintrag übernommen, statt sie manuell einzugeben.

User Journey:
	1.	Der Admin ruft den Import-Endpunkt mit einer gültigen Node-ID auf.
	2.	Das System lädt die XML-Daten von OSM.
	3.	Die Daten werden geparst und gespeichert.
	4.	Der Endpunkt gibt den importierten POS als JSON zurück.

Pain Points Addressed:
	•	Keine manuelle Eingabe von Adressen und Geodaten.
	•	Schnellere und konsistente Erfassung neuer Standorte.

⸻

Why

Business Value & Impact:
Vereinheitlicht die POS-Erfassung und spart Zeit bei der Datenpflege.
Erhöht Datenqualität durch direkte Übernahme geprüfter OSM-Informationen.

Integration mit bestehenden Features:
Erweitert das bestehende POS-Modul (/api/pos) um eine neue Import-Funktion.
Verwendet vorhandene Daten- und Domain-Module.

⸻

What

User-visible behavior & technische Anforderungen:

Der Ablauf des Features umfasst vier Hauptschritte:
	1.	Abruf der Daten von der OSM-API
– Endpunkt: https://www.openstreetmap.org/api/0.6/node/{nodeId} (z. B. 5589879349)
– Lade XML-Daten des Nodes herunter und behandle Fehlerfälle robust (404, 5xx).
	2.	Lesen und Umwandeln der XML-Daten
– Extrahiere relevante Informationen (name, addr:street, addr:city, lat, lon).
– Wandle die Daten in ein internes Java-Objekt um (z. B. PointOfSaleData).
	3.	Übernahme in das CampusCoffee-System
– Übertrage die Daten in das Datenbanksystem.
– Wenn osmNodeId existiert → aktualisieren; sonst neuen Eintrag anlegen.
	4.	Bereitstellung über einen REST-Endpunkt
– POST /api/pos/import/osm/{nodeId} löst den Import aus.
– Erfolgreiche Antwort enthält den importierten POS als JSON.

Ergänzungen:
– einfache Tests (Parsing, Mapping, Persistenz)
– kurze technische Doku (z. B. Javadoc oder README-Abschnitt)

⸻

Success Criteria
	•	Der Endpoint ist über POST /api/pos/import/osm/{nodeId} erreichbar.
	•	201 Created bei Neuanlage, 200 OK bei Aktualisierung.
	•	404 Not Found, 422 Unprocessable Entity und 502 Bad Gateway für Fehlerfälle.
	•	Mehrfacher Aufruf derselben Node-ID erzeugt keine Duplikate.
	•	Tests und Doku vorhanden; Code folgt Java-21- und Spring-Boot-Konventionen.

⸻

Documentation & References
	•	README.md enthält Setup-Anleitung und Beispiel-API-Aufrufe.
	•	Architektur: Multi-Modul-Maven-Projekt (Ports-and-Adapters).
	•	api – Controller-Adapter
	•	application – Spring-Boot-App + Systemtests
	•	data – Daten-Adapter
	•	domain – Business-Logik und Ports

⸻

Prompt Instruction (für Cursor-Eingabe)

Entwickle für das bestehende CampusCoffee-Projekt das oben beschriebene Feature.
Implementiere die vier beschriebenen Schritte (OSM-Abruf → XML-Parsing → Datenübernahme → REST-Bereitstellung) in sauberen,  Java-21/Spring-Boot-Klassen.
Ergänze Tests und kurze Doku.
Wenn vorhandene Modell- oder Repository-Klassen unklar sind, triff minimale Annahmen und nenne sie am Ende.
Gib vollständige Codeblöcke und Dateipfade an.